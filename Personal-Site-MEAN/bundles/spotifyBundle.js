!function(){"use strict";angular.module("spotifyApp",[])}(),function(){"use strict";angular.module("spotifyApp").directive("playerColumn",function(){return{restrict:"E",templateUrl:"/modules/spotify/client/templates/playerColumn.html"}}).directive("predictionColumn",function(){return{restrict:"E",templateUrl:"/modules/spotify/client/templates/predictionColumn.html",controller:"PredictionController"}}).directive("tableColumn",function(){return{restrict:"E",templateUrl:"/modules/spotify/client/templates/tableColumn.html",controller:"TableController",link:function(t,e){$("table").tablesort()}}}).directive("descriptionPanels",function(){return{restrict:"E",templateUrl:"/modules/spotify/client/templates/descriptionPanels.html",link:function(t,e){for(var i=1;i<=4;i++)$("#heading-"+i).click(function(){var t=$(this).attr("id").split("-")[1],e="#collapse-"+t;$(e).collapse("toggle");var i=$(this).children("h4").children("span");"true"==$(e).attr("aria-expanded")?i.attr("class","panelArrow glyphicon glyphicon-chevron-up"):i.attr("class","panelArrow glyphicon glyphicon-chevron-down")})}}})}(),function(){"use strict";function t(t){function e(){var t={apiSettings:{url:"https://api.spotify.com/v1/search?q={query}&type=track",onResponse:function(t){var e={results:[]};return $.each(t.tracks.items,function(t,i){e.results.push({title:i.name,description:i.artists[0].name,image:i.album.images[2].url,id:i.id})}),e}},fields:{results:"results",title:"title",description:"description",image:"image"},minCharacters:3,onSelect:function(t,e){r.getPrediction(t.id),r.selectedSong=t.title,r.selectedArtist=t.description;var i="https://embed.spotify.com/?uri=spotify:track:"+t.id;$("#spotifyPlayer").attr("src",i)}};return t}function i(e){t.get("/spotify/getPrediction/"+e).then(function(t){var e=t.data["Scored Labels"],i=100*t.data["Scored Probabilities"],n="likely";"False"==e&&(i=100-i,n="not likely"),r.prediction=n,r.probability=i.toFixed(2)+"%"},function(t){r.errorText=t.data})}var r=this;r.getPrediction=i,r.songSearch=n,r.errorText="",r.prediction="",r.probability="",r.selectedSong="",r.selectedArtist="";var n=$("#songSearch").search(e())}angular.module("spotifyApp").controller("PredictionController",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){function e(e){void 0!==r.billboardListCache[e]?r.billboardSongs=r.billboardListCache[e]:t.get("/spotify/getYearList/"+e).then(function(t){var i=[];$.each(t.data,function(t,e){i.push({Position:e.Position,Song:e.Song,Artist:e.Artist})}),r.billboardListCache[e]=i,r.billboardSongs=null,r.billboardSongs=i})}function i(){var t=2015;r.availableYears=[];for(var e=((new Date).getFullYear(),t);e>=1946;e--)r.availableYears.push(e);r.selectedYear=t}var r=this;r.getYearList=e,r.populateDropdown=i,r.availableYears=[],r.billboardListCache={},r.billboardSongs=[],r.selectedYear=2015,e(r.selectedYear),i()}angular.module("spotifyApp").controller("TableController",t),t.$inject=["$http"]}(),function(t){t.tablesort=function(e,i){var r=this;this.$table=e,this.settings=t.extend({},t.tablesort.defaults,i),this.$table.find("thead th").bind("click.tablesort",function(){t(this).hasClass("disabled")||r.sort(t(this))}),this.index=null,this.$th=null,this.direction=[]},t.tablesort.prototype={sort:function(e,i){var r=new Date,n=this,a=this.$table,o=a.find("tbody tr"),s=e.index(),l=[],c=t("<div/>"),d=function(t,e,i){var r;return t.data().sortBy?(r=t.data().sortBy,"function"==typeof r?r(t,e,i):r):e.data("sort")?e.data("sort"):e.text()},u=function(t,e){var i,r,n,a=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,c=/^0/,d=function(t){return(""+t).toLowerCase().replace(",","")},u=d(t).replace(o,"")||"",p=d(e).replace(o,"")||"",h=u.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=p.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),b=Math.max(h.length,f.length),g=parseInt(u.match(l),10)||1!=h.length&&u.match(s)&&Date.parse(u),m=parseInt(p.match(l),10)||g&&p.match(s)&&Date.parse(p)||null;if(m){if(g<m)return-1;if(g>m)return 1}for(n=0;n<b;n++){if(i=!(h[n]||"").match(c)&&parseFloat(h[n])||h[n]||0,r=!(f[n]||"").match(c)&&parseFloat(f[n])||f[n]||0,isNaN(i)!==isNaN(r))return isNaN(i)?1:-1;if(typeof i!=typeof r&&(i+="",r+=""),i<r)return-1;if(i>r)return 1}return 0};0!==o.length&&(n.$table.find("thead th").removeClass(n.settings.asc+" "+n.settings.desc),this.$th=e,this.index!=s?this.direction[s]="desc":"asc"!==i&&"desc"!==i?this.direction[s]="desc"===this.direction[s]?"asc":"desc":this.direction[s]=i,this.index=s,i="asc"==this.direction[s]?1:-1,n.$table.trigger("tablesort:start",[n]),n.log("Sorting by "+this.index+" "+this.direction[s]),o.sort(function(r,a){var o=t(r),s=t(a),c=o.index(),p=s.index();return l[c]?r=l[c]:(r=d(e,n.cellToSort(r),n),l[c]=r),l[p]?a=l[p]:(a=d(e,n.cellToSort(a),n),l[p]=a),u(r,a)*i}),o.each(function(t,e){c.append(e)}),a.append(c.html()),e.addClass(n.settings[n.direction[s]]),n.log("Sort finished in "+((new Date).getTime()-r.getTime())+"ms"),n.$table.trigger("tablesort:complete",[n]))},cellToSort:function(e){return t(t(e).find("td").get(this.index))},log:function(e){(t.tablesort.DEBUG||this.settings.debug)&&console&&console.log&&console.log("[tablesort] "+e)},destroy:function(){return this.$table.find("thead th").unbind("click.tablesort"),this.$table.data("tablesort",null),null}},t.tablesort.DEBUG=!1,t.tablesort.defaults={debug:t.tablesort.DEBUG,asc:"sorted ascending",desc:"sorted descending"},t.fn.tablesort=function(e){var i,r;return this.each(function(){i=t(this),r=i.data("tablesort"),r&&r.destroy(),i.data("tablesort",new t.tablesort(i,e))})}}(jQuery);